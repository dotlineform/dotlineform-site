<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% if page.title and page.title != site.title %}{{ page.title }} | {{ site.title }}{% else %}{{ site.title }}{% endif %}</title>

  {% if page.description %}
  <meta name="description" content="{{ page.description | escape }}">
  {% endif %}

  <script>
    (function () {
      try {
        var t = localStorage.getItem('theme');
        document.documentElement.setAttribute('data-theme', (t === 'light' || t === 'dark') ? t : 'auto');
      } catch (e) {
        document.documentElement.setAttribute('data-theme', 'auto');
      }
    })();
  </script>

  <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}">
</head>
<body>
  <header class="site-header">
    <div class="container">
      <div class="site-title">
        <a href="{{ '/' | relative_url }}">{{ site.title }}</a>
      </div>
      <nav class="site-nav">
        <!-- Catalogue nav item -->
        {% if page.path == 'catalogue/index.md' or page.path == 'catalogue/works/index.md' %}
          <span class="nav-item is-active" aria-current="page">catalogue</span>

        {% elsif page.collection == 'works' or page.collection == 'catalogue_notes' %}
          <a class="nav-item is-active" href="{{ '/catalogue/' | relative_url }}" aria-current="page">catalogue</a>

        {% elsif page.path contains 'catalogue/' %}
          <a class="nav-item is-active" href="{{ '/catalogue/' | relative_url }}" aria-current="page">catalogue</a>

        {% else %}
          <a class="nav-item" href="{{ '/catalogue/' | relative_url }}">catalogue</a>
        {% endif %}
        
        <!-- Poems nav item -->
        {% if page.path == 'poems/index.md' %}
          <span class="nav-item is-active" aria-current="page">poems</span>

        {% elsif page.collection == 'poems' %}
          <a class="nav-item is-active" href="{{ '/poems/' | relative_url }}" aria-current="page">poems</a>

        {% else %}
          <a class="nav-item" href="{{ '/poems/' | relative_url }}">poems</a>
        {% endif %}

         <!-- Notes nav item -->
        {% if page.path == 'notes/index.md' %}
          <span class="nav-item is-active" aria-current="page">notes</span>

        {% elsif page.collection == 'notes' %}
          <a class="nav-item is-active" href="{{ '/notes/' | relative_url }}" aria-current="page">notes</a>

        {% else %}
          <a class="nav-item" href="{{ '/notes/' | relative_url }}">notes</a>
        {% endif %}
      </nav>
      <div class="site-header-spacer" aria-hidden="true"></div>
    </div>
  </header>

  <main class="container">
    {{ content }}
  </main>

  <footer class="site-footer">
    <div class="container">
      <span class="muted">Â© {{ site.time | date: "%Y" }} {{ site.title }}</span>
      <button class="theme-toggle" type="button" id="themeToggle" aria-label="Toggle theme">theme: auto</button>
    </div>
  </footer>

  <script>
    (function () {
      var btn = document.getElementById('themeToggle');
      if (!btn) return;

      function getTheme() {
        return document.documentElement.getAttribute('data-theme') || 'auto';
      }

      function setTheme(t) {
        document.documentElement.setAttribute('data-theme', t);
        try {
          if (t === 'auto') localStorage.removeItem('theme');
          else localStorage.setItem('theme', t);
        } catch (e) {}
        btn.textContent = 'theme: ' + t;
      }

      function nextTheme(t) {
        if (t === 'auto') return 'light';
        if (t === 'light') return 'dark';
        return 'auto';
      }

      setTheme(getTheme());

      btn.addEventListener('click', function () {
        setTheme(nextTheme(getTheme()));
      });
    })();
  </script>
</body>
</html>