---
layout: default
---

<article class="page theme">
  <header class="page__header">
    <h1 class="page__title">{{ page.title }}</h1>
    {% if page.date %}
      <p class="page__meta muted small">{{ page.date | date: "%-d %b %Y" }}</p>
    {% endif %}
  </header>

  <div class="content">
    {{ content }}
  </div>

  {%- assign work_ids = page.work_ids | default: page.works -%}

  {%- if work_ids and work_ids != empty -%}
    <hr>
    <section class="theme__works">
      <div class="index">
        <h2 class="index__heading">selected work</h2>

        {%- assign media_base = site.media_base | default: "" -%}
        {%- assign asset_root = site.media_prefix | default: "/assets" -%}
        {%- assign works_img_prefix = asset_root | append: "/works/img" -%}
        {%- assign works_img_base = media_base | append: works_img_prefix | append: "/" -%}

        {%- for wid in work_ids -%}
          {%- assign work_doc = site.works | where: 'work_id', wid | first -%}
          {%- if work_doc -%}
            {%- assign thumb96 = works_img_base | append: wid | append: "-thumb-96.webp" -%}
            {%- assign thumb192 = works_img_base | append: wid | append: "-thumb-192.webp" -%}
            {%- unless works_img_base contains '://' -%}
              {%- assign thumb96 = thumb96 | relative_url -%}
              {%- assign thumb192 = thumb192 | relative_url -%}
            {%- endunless -%}

            <div class="index__item index__item--single">
              <a class="index__link" href="{{ work_doc.url | relative_url }}">
                <img
                  class="index__thumb"
                  src="{{ thumb96 }}"
                  srcset="{{ thumb96 }} 96w, {{ thumb192 }} 192w"
                  sizes="48px"
                  width="48"
                  height="48"
                  alt="{{ wid }} thumbnail"
                  loading="lazy"
                  decoding="async">
                {{ work_doc.title | default: work_doc.slug | default: 'Untitled' }} [{{ wid }}]
              </a>
            </div>
          {%- else -%}
            <div class="index__item index__item--single">
              <a class="index__link" href="{{ '/works/' | append: wid | append: '/' | relative_url }}">Untitled [{{ wid }}]</a>
            </div>
          {%- endif -%}
        {%- endfor -%}
      </div>
    </section>
  {%- endif -%}

  {% if page.html_inserts and page.html_inserts.size > 0 %}
    <hr>
    <section class="supplements">
      <h2>Supplements</h2>
      <div class="supplements__links">
        {% for item in page.html_inserts %}
          {% if item.path %}
            {% assign href = item.path %}
            {% assign text = item.label | default: item.path %}
          {% elsif item.file %}
            {% assign href = '/assets/themes/html/' | append: item.file %}
            {% assign text = item.label | default: item.file %}
          {% else %}
            {% assign href = '/assets/themes/html/' | append: item %}
            {% assign text = item %}
          {% endif %}
          {% assign out_href = href %}
          {% unless out_href contains '://' %}
            {% assign out_href = out_href | relative_url %}
          {% endunless %}
          <p class="supplements__link">ðŸ”— <a href="{{ out_href }}">{{ text | escape }}</a></p>
        {% endfor %}
      </div>
    </section>
  {% endif %}
</article>